{% extends 'upvote/layout/base.html' %}
{% load static %}

{% block content %}
  {% include 'upvote/partials/carousel.html' %}
  <section class="container-fluid bg-white">
    <div class="container">
      <div class="row pt-5 pb-5">
        <div class="col-12 col-md-8 offset-md-2">
          <span class="d-block mx-auto">
            <h1 id="subtext">SINCE WE'LL HAVE TO CHANGE OUR TERMINOLOGY, LET'S MAKE SOME SUGGESTIONS.</h1>
          </span>
          <form method="post" action="{% url 'upvote:index' %}" class="form-group row my-4">
            {% csrf_token %}
              <div class="col-12 col-sm-8">
                {{ submission_form }}
              </div>
              <button type="submit" id="search-btn" class="btn col-12 col-sm-2">
                SUBMIT A REPLACEMENT FOR THE WORD "BANKING"
                <!-- <img class="col-md-1 pt-1" src="public/...">
                      -->
              </button>
            </form>
            <!--<div class="row">
              <div class="col">
                <a href="#most-popular" class="filter-titles">MOST POPULAR</a>
              </div>
              <div class="col">
                <a href="#most-recent" class="filter-titles">MOST RECENT</a>
              </div>
              <div class="col">
                <a href="#random" class="filter-titles">RANDOM</a>
              </div>
            </div>-->
            {% if top_submissions %}
              <div class="row infinite-container">
                <div class="col-12">
                  {% for submission in top_submissions %}
                    <div class="row bg-purple infinite-item align-items-center justify-content-between p-4 mb-2">
                      <div class="col-8">
                        <a href="{% url 'upvote:detail' submission.word %}">
                          <h1 id="user-submission">{{ submission.word }}</h1>
                        </a>
                      </div>
                      <div class="col-2 logo-base">
                        <form id="vote" action="{% url 'upvote:vote' submission.word %}" method="post">
                          {% csrf_token %}
                          <button type="submit" class="vote-btn">
                            <img src="{% static 'upvote/images/unbanking_icon_heart.png' %}" class="logo img-fluid d-block mx-auto pb-2"/>
                          </button>
                        </form>
                        <h3 class="entry-subtext">{{ submission.vote_set.count }}</h3>
                      </div>
                      <div class="col-2 logo-base dropdown">
                        <div id="dLabel" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          <img src="{% static 'upvote/images/unbanking_icon_share.png' %}" class="logo img-fluid d-block mx-auto pb-2"/>
                          <div class="d-block mx-auto">
                            <h3 class="entry-subtext">SHARE</h3>
                          </div>
                        </div>
                        <div class="dropdown-menu" aria-labelledby="dLabel">
                          <a class="dropdown-item" href="#">Twitter</a>
                          <a class="dropdown-item" href="#">Facebook</a>
                          <a class="dropdown-item" href="#">Linkedin</a>
                        </div>
                      </div>
                    </div>
                  {% endfor %}
                </div>
              </div>
              <div class="row bg-purple loading" style="display: none;">
                <div class="col-12 pt-2 pl-4">
                  <h1>Loading...</h1>
                </div>
              </div>
              {% if top_submissions.has_next %}
                <div class="col-12 pt-5 pb-5">
                  <div class="d-block mx-auto">
                    <a class="btn btn-lg" class="infinite-more-link" href="?page={{ top_submissions.next_page_number }}">Load More</a>
                  </div>
                </div>
              {% endif %}
            {% else %}
              <div class="row">
                <div class="col-12">
                  <p>Be the first to add your word!</p>
                </div>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </section>
    <script>
        var infinite = new Waypoint.Infinite({
            element: $('.infinite-container')[0],
            onBeforePageLoad: function () {
                $('.loading').show();
            },
            onAfterPageLoad: function ($items) {
                $('.loading').hide();
            }
        });
    </script>
{% endblock %}